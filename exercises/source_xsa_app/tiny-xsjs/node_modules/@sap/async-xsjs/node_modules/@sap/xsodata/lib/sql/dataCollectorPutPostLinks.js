'use strict';

//Include

var dataCollector2 = require('./dataCollector2');
var statementProcessor = require('./statementProcessor');

exports.insertTmpTableToRealMNTable = function (context, asyncDone) {
	var dbSeg = context.oData.dbSegmentLast;

	statementProcessor.execStmsAsPrepared(context,dbSeg.sql.stmContainer.insertReal,
    (err, context, resultset) => {
        if (err) {
            return asyncDone(err, context);
        }
        return dataCollector2.resultSetCheckRowCountForUpdate(context, resultset, 0, 1, asyncDone);
    });
};
