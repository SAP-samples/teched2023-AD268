'use strict';
var Http403_Forbidden = require('../../utils/errors/http/forbidden');

module.exports = function checkAllowedMethods(){

    var verbs = Array.prototype.slice.apply(arguments);

    return function(context, callback){
        var verbAllowed = verbs.some(function(verb){
            return context.request.method.toLowerCase() === verb;
        });

        if (!verbAllowed){
            return callback(new Http403_Forbidden(), context);
        }

        return callback(null, context);
    };

};


