'use strict';

var Manager = require('./lib/Manager');
var MigrationManager = require('./lib/MigrationManager');

/**
 * Returns whether the library supports MigrationManager.
 */
exports.hasMigrationSupport = true;

/**
 *
 * @param {object} options - Credentials for Instance/Service Manager. In order to use the migration functionality, you need to provide both in an object { imOpts: {...}, smOpts: {...} }.
 * @param {function} callback - function to be called back with (err, manager).
 */
exports.create = function (options, callback) {
  var manager = (options.imOpts && options.smOpts) ? new MigrationManager(options) : new Manager(options);
  manager.init(function (err) {
    if (err) {
      return callback(err);
    }

    manager.getAll(function (err) {
      if (err) {
        return callback(err);
      }

      callback(null, manager);
    });
  });
};
